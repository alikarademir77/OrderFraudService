def appName="bby-orders-fraud-service"
def project="ecomm-orders-team"

node('maven') {

    stage('Checkout Source Code') {
        checkout scm
    }

    stage('Build') {
        sh "mvn clean compile"
    }

//    stage('Execute Tests') {
//        sh "mvn test"
//    }

    stage('Package') {
        sh "mvn package -DskipTests=true"
        sh "mkdir run"
        sh "mv target/*.jar run/${appName}.jar"
        sh "mv openshift-config/Dockerfile run/Dockerfile"
    }

    stage('Create Container Image') {

        sh "oc start-build ${appName} --from-dir=run --follow -n ${project}"

    }
}