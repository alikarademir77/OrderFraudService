-- Generated by Oracle SQL Developer Data Modeler 17.2.0.188.1059
--   at:        2018-03-06 17:35:17 PST
--   site:      Oracle Database 12c
--   type:      Oracle Database 12c

CREATE TABLE ID_GENERATOR (
	GENERATED_NAME VARCHAR(80) NOT NULL,
	GENERATED_VALUE NUMBER NOT NULL
);
ALTER TABLE ID_GENERATOR ADD CONSTRAINT ID_GENERATOR_PK PRIMARY KEY ( GENERATED_NAME );

INSERT INTO ID_GENERATOR (GENERATED_NAME, GENERATED_VALUE) VALUES ('FRAUDREQUESTID', 0);
INSERT INTO ID_GENERATOR (GENERATED_NAME, GENERATED_VALUE) VALUES ('FRAUDREQUESTHISTORYID', 0);

CREATE TABLE FRAUDREQUEST (
    FRAUDREQUESTID    NUMBER NOT NULL,
--  fs order number
    ORDERNUMBER       NUMBER NOT NULL,
--  every time oms moves the fso to fraud check required,we will create a new version
    REQUESTVERSION    INTEGER NOT NULL,
    REQUESTTYPECODE   VARCHAR2(80 CHAR) NOT NULL,
    FRAUDSTATUSCODE   VARCHAR2(80 CHAR) NOT NULL,
    CREATEDATE        DATE NOT NULL,
    CREATEUSER        VARCHAR2(80 CHAR) NOT NULL,
    UPDATEDATE        DATE NOT NULL,
    UPDATEUSER        VARCHAR2(80 CHAR) NOT NULL
);
ALTER TABLE FRAUDREQUEST ADD CONSTRAINT FRAUDREQUEST_PK PRIMARY KEY ( FRAUDREQUESTID ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;
ALTER TABLE FRAUDREQUEST ADD CONSTRAINT FRAUDREQUEST_UN UNIQUE ( ORDERNUMBER, REQUESTVERSION ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;

CREATE TABLE FRAUDREQUESTHISTORY (
    FRAUDREQUESTHISTORYID   NUMBER NOT NULL,
    FRAUDREQUESTID          NUMBER NOT NULL,
    ORDERNUMBER             NUMBER NOT NULL,
    REQUESTVERSION          INTEGER NOT NULL,
    REQUESTTYPECODE         VARCHAR2(80) NOT NULL,
    FRAUDSTATUSCODE         VARCHAR2(80 CHAR) NOT NULL,
    CREATEDATE             	DATE NOT NULL,
    CREATEUSER              VARCHAR2(80 CHAR) NOT NULL,
    UPDATEDATE              DATE NOT NULL,
    UPDATEUSER              VARCHAR2(80) NOT NULL
);
ALTER TABLE FRAUDREQUESTHISTORY ADD CONSTRAINT FRAUDREQUESTHISTORY_PK PRIMARY KEY ( FRAUDREQUESTHISTORYID ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;

CREATE TABLE FRAUDREQUESTHISTORYDETAILS (
    FRAUDREQUESTHISTORYID   NUMBER NOT NULL,
    TASREQUEST              CLOB NOT NULL,
    TASRESPONSE             CLOB NOT NULL,
    CREATEDATE              DATE NOT NULL,
    CREATEUSER              VARCHAR2(80) NOT NULL,
    UPDATEDATE              DATE NOT NULL,
    UPDATEUSER              VARCHAR2(80) NOT NULL
);
ALTER TABLE FRAUDREQUESTHISTORYDETAILS ADD CONSTRAINT FRAUDREQUESTHISTORYDETAILS_PK PRIMARY KEY ( FRAUDREQUESTHISTORYID ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;

CREATE TABLE FRAUDSTATUSES (
    FRAUDSTATUSCODE          VARCHAR2(80) NOT NULL,
    FRAUDSTATUSDESCRIPTION   VARCHAR2(2000 CHAR),
    CREATEDATE               DATE NOT NULL,
    CREATEUSER               VARCHAR2(80) NOT NULL,
    UPDATEDATE               DATE NOT NULL,
    UPDATEUSER               VARCHAR2(80) NOT NULL
);
ALTER TABLE FRAUDSTATUSES ADD CONSTRAINT FRAUDSTATUSES_PK PRIMARY KEY ( FRAUDSTATUSCODE ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;

INSERT INTO FRAUDSTATUSES (FRAUDSTATUSCODE, FRAUDSTATUSDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('INITIAL_REQUEST', 'Initial request received.', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');

INSERT INTO FRAUDSTATUSES (FRAUDSTATUSCODE, FRAUDSTATUSDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('DECISION_MADE', 'Final fraud decision is made.', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');

INSERT INTO FRAUDSTATUSES (FRAUDSTATUSCODE, FRAUDSTATUSDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('PENDING_REVIEW', 'Fraud decision is pending manual review.', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');

INSERT INTO FRAUDSTATUSES (FRAUDSTATUSCODE, FRAUDSTATUSDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('CANCELLED', 'Fraud assessment is canceled.', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');


CREATE TABLE FRAUDREQUESTTYPES (
    REQUESTTYPECODE          VARCHAR2(80 CHAR) NOT NULL,
    REQUESTTYPEDESCRIPTION   VARCHAR2(2000),
    CREATEDATE               DATE NOT NULL,
    CREATEUSER               VARCHAR2(80) NOT NULL,
    UPDATEDATE               DATE NOT NULL,
    UPDATEUSER               VARCHAR2(80 CHAR) NOT NULL
);

INSERT INTO FRAUDREQUESTTYPES (REQUESTTYPECODE, REQUESTTYPEDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('FRAUD_CHECK', 'Fraud check request', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');

INSERT INTO FRAUDREQUESTTYPES (REQUESTTYPECODE, REQUESTTYPEDESCRIPTION, CREATEDATE, CREATEUSER, UPDATEDATE, UPDATEUSER) 
VALUES ('ORDER_CANCEL', 'Order cancellation', SYSDATE, 'ORDER_FRAUD_SCRIPT', SYSDATE, 'ORDER_FRAUD_SCRIPT');


ALTER TABLE FRAUDREQUESTTYPES ADD CONSTRAINT FRAUDREQUESTTYPES_PK PRIMARY KEY ( REQUESTTYPECODE ) USING INDEX TABLESPACE ORDERFRAUD_INDEX;

ALTER TABLE FRAUDREQUEST
    ADD CONSTRAINT FRDRQST_FRDSTATUSES_FK FOREIGN KEY ( FRAUDSTATUSCODE )
        REFERENCES FRAUDSTATUSES ( FRAUDSTATUSCODE );

ALTER TABLE FRAUDREQUEST
    ADD CONSTRAINT FRDRQST_RQST_TYPS_FK FOREIGN KEY ( REQUESTTYPECODE )
        REFERENCES FRAUDREQUESTTYPES ( REQUESTTYPECODE );

ALTER TABLE FRAUDREQUESTHISTORY 
    ADD CONSTRAINT FRDRQSTHSTRY_FRDRQST_FK FOREIGN KEY ( FRAUDREQUESTID ) 
        REFERENCES FRAUDREQUEST ( FRAUDREQUESTID );

ALTER TABLE FRAUDREQUESTHISTORY
    ADD CONSTRAINT FRDRQSTHSTRY_FRDSTATUSES_FK FOREIGN KEY ( FRAUDSTATUSCODE )
        REFERENCES FRAUDSTATUSES ( FRAUDSTATUSCODE );

ALTER TABLE FRAUDREQUESTHISTORY
    ADD CONSTRAINT FRDRQSTHSTRY_RQSTTYPS_FK FOREIGN KEY ( REQUESTTYPECODE )
        REFERENCES FRAUDREQUESTTYPES ( REQUESTTYPECODE );

ALTER TABLE FRAUDREQUESTHISTORYDETAILS
    ADD CONSTRAINT FRDRQSTHSTRYDTL_FRDRQSTHTRY_FK FOREIGN KEY ( FRAUDREQUESTHISTORYID )
        REFERENCES FRAUDREQUESTHISTORY ( FRAUDREQUESTHISTORYID );

GRANT SELECT ON "ORDER_FRAUD"."FRAUDREQUEST" TO ORDERFRAUD_READ_ROLE;
GRANT INSERT ON "ORDER_FRAUD"."FRAUDREQUEST" TO ORDERFRAUD_WRITE_ROLE;
GRANT UPDATE ON "ORDER_FRAUD"."FRAUDREQUEST" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT DELETE ON "ORDER_FRAUD"."FRAUDREQUEST" TO ORDERFRAUD_DELETE_ROLE;

GRANT SELECT ON "ORDER_FRAUD"."FRAUDREQUESTHISTORY" TO ORDERFRAUD_READ_ROLE;
GRANT INSERT ON "ORDER_FRAUD"."FRAUDREQUESTHISTORY" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT UPDATE ON "ORDER_FRAUD"."FRAUDREQUESTHISTORY" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT DELETE ON "ORDER_FRAUD"."FRAUDREQUESTHISTORY" TO ORDERFRAUD_DELETE_ROLE;

GRANT SELECT ON "ORDER_FRAUD"."FRAUDREQUESTHISTORYDETAILS" TO ORDERFRAUD_READ_ROLE;
GRANT INSERT ON "ORDER_FRAUD"."FRAUDREQUESTHISTORYDETAILS" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT UPDATE ON "ORDER_FRAUD"."FRAUDREQUESTHISTORYDETAILS" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT DELETE ON "ORDER_FRAUD"."FRAUDREQUESTHISTORYDETAILS" TO ORDERFRAUD_DELETE_ROLE;

GRANT SELECT ON "ORDER_FRAUD"."FRAUDSTATUSES" TO ORDERFRAUD_READ_ROLE;
-- GRANT INSERT ON "ORDER_FRAUD"."FRAUDSTATUSES" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT UPDATE ON "ORDER_FRAUD"."FRAUDSTATUSES" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT DELETE ON "ORDER_FRAUD"."FRAUDSTATUSES" TO ORDERFRAUD_DELETE_ROLE;

GRANT SELECT ON "ORDER_FRAUD"."FRAUDREQUESTTYPES" TO ORDERFRAUD_READ_ROLE;
-- GRANT INSERT ON "ORDER_FRAUD"."FRAUDREQUESTTYPES" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT UPDATE ON "ORDER_FRAUD"."FRAUDREQUESTTYPES" TO ORDERFRAUD_WRITE_ROLE;
-- GRANT DELETE ON "ORDER_FRAUD"."FRAUDREQUESTTYPES" TO ORDERFRAUD_DELETE_ROLE;

GRANT SELECT ON "ORDER_FRAUD"."ID_GENERATOR" TO ORDERFRAUD_READ_ROLE;
GRANT UPDATE ON "ORDER_FRAUD"."ID_GENERATOR" TO ORDERFRAUD_WRITE_ROLE;


-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                             5
-- CREATE INDEX                             0
-- ALTER TABLE                             12
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           1
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          1
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- TSDP POLICY                              0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
